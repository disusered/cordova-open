machine:
  node:
    version: 0.10.22
  environment:
    ANDROID_HOME: /home/ubuntu/android
dependencies:
  cache_directories:
    - ~/.android
    - ~/android
  override:
    - ./bin/deps.sh
  pre:
    - npm install -g cordova
  post:
    - cordova create /home/ubuntu/test com.bridge.test Test
    - cd /home/ubuntu/test && cordova platform add android
    - cd /home/ubuntu/test && cordova plugin add http://git-wip-us.apache.org/repos/asf/cordova-plugin-test-framework.git
    - cd /home/ubuntu/test && cordova plugin add ../cordova-open
    - cd /home/ubuntu/test && cordova plugin add ../cordova-open/tests
test:
  override:
  - $ANDROID_HOME/tools/emulator -avd testing -no-window -no-boot-anim -no-audio:
      background: true
      parallel: true
  - cd /home/ubuntu/test && cordova build android
  - ./bin/wait.sh:
      parallel: true
  - $ANDROID_HOME/platform-tools/adb install /home/ubuntu/test/platforms/android/ant-build/CordovaApp-debug.apk
